# Sensory Expression Screen (Step3)

## ğŸ¯ í™”ë©´ ê°œìš”

ì»¤í”¼ì˜ ê°ê°ì  ê²½í—˜ì„ í‘œí˜„í•˜ëŠ” í™”ë©´ì…ë‹ˆë‹¤. ëª¨ë“œë³„ë¡œ ì ‘ê·¼ ë°©ì‹ì´ ë‹¤ë¥´ì§€ë§Œ, í•µì‹¬ì€ ì‚¬ìš©ìì˜ ì£¼ê´€ì  ê°ê°ì„ êµ¬ì²´ì  ì–¸ì–´ë¡œ í‘œí˜„í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

### í™”ë©´ ìœ„ì¹˜
- **ë¼ìš°íŒ…**: `/record/step3`
- **ì§„í–‰ë¥ **: 75% (3/4)
- **ì´ì „ í™”ë©´**: Taste Evaluation (Step2)
- **ë‹¤ìŒ í™”ë©´**: Personal Notes & Result (Step4)

## ğŸ§  ê°ê° í‘œí˜„ ì² í•™

### 7/29 ì²´í¬í¬ì¸íŠ¸ ê¸°ë°˜ ì„¤ê³„ ì›ì¹™

#### ê°ê° ì¹´í…Œê³ ë¦¬ ë‹¨ìˆœí™” (6ê°œ â†’ 4ê°œ)
```yaml
Before (ë³µì¡í•¨):
  - í–¥ (Aroma)
  - ë§› (Taste) 
  - ì´‰ê° (Mouthfeel)
  - ë’·ë§› (Aftertaste)
  - ê· í˜•ê° (Balance)
  - ì „ì²´ì  ëŠë‚Œ (Overall)

After (ë‹¨ìˆœí™”ë¨):
  - ğŸŒ¸ í–¥ (Aroma): "ì²«ì¸ìƒì˜ í–¥ê¸°"
  - ğŸ‘… ë§› (Flavor): "ì…ì•ˆì—ì„œ ëŠë¼ëŠ” ë§›"
  - ğŸ¤² ì´‰ê° (Body): "ì…ì•ˆì˜ ë¬´ê²Œê°ê³¼ ì§ˆê°"
  - ğŸ’« ì—¬ìš´ (Finish): "ì‚¼í‚¨ í›„ ë‚¨ëŠ” ëŠë‚Œ"
```

#### í‘œí˜„ ë°©ì‹ì˜ ì´ì¤‘í™”
```yaml
Dual Expression System:
  ì „ë¬¸ê°€ ëª¨ë“œ:
    - SCA í‘œì¤€ ìš©ì–´
    - ê°ê´€ì  ë””ìŠ¤í¬ë¦½í„°
    - ì ìˆ˜ ê¸°ë°˜ í‰ê°€
  
  ì¼ë°˜ì¸ ëª¨ë“œ:
    - ì¼ìƒì  í‘œí˜„
    - ê°ì •ì  ì—°ê²°
    - ì§ê´€ì  ì„ íƒ
    
  ì—°ê²° ì‹œìŠ¤í…œ:
    - "ë‹¬ì½¤í•œ" â†” "Sweet"
    - "ì‹œì›í•œ" â†” "Bright/Clean"
    - "ë¶€ë“œëŸ¬ìš´" â†” "Smooth"
```

## ğŸ¨ ëª¨ë“œë³„ í™”ë©´ êµ¬ì„±

### â˜• Cafe Mode: ì§ê´€ì  ê°ê° í‘œí˜„

#### ì²´í¬í¬ì¸íŠ¸ ë°˜ì˜ - ê°ì •ì  ì—°ê²° ì¤‘ì‹¬
```yaml
Screen Philosophy:
  - "ì–´ë–¤ ëŠë‚Œì´ì—ˆë‚˜ìš”?" ì ‘ê·¼
  - ë³µì¡í•œ ìš©ì–´ ëŒ€ì‹  ì¼ìƒ ì–¸ì–´
  - ë¹ ë¥¸ ì„ íƒ (30ì´ˆ ëª©í‘œ)

Content Structure:
  í–¥ (ì²«ì¸ìƒ):
    - ë‹¬ì½¤í•œ í–¥, ê³ ì†Œí•œ í–¥, ê½ƒí–¥ê¸°, ê³¼ì¼í–¥ê¸°
    - ìƒˆì½¤í•œ í–¥, ìŠ¤ëª¨í‚¤í•œ í–¥, í™ë‚´ìŒ, ìƒí¼í•œ í–¥
  
  ë§› (ì…ì•ˆì—ì„œ):
    - ë‹¬ì½¤í•¨, ì“´ë§›, ì‹ ë§›, ì§ ë§›
    - ê³ ì†Œí•¨, ê¹”ë”í•¨, ì§„í•¨, ê°€ë²¼ì›€
  
  ì´‰ê° (ì§ˆê°):
    - ë¶€ë“œëŸ¬ì›€, ê±°ì¹ ìŒ, ë¬´ê±°ì›€, ê°€ë²¼ì›€
    - í¬ë¦¬ë¯¸í•¨, ì‚°ëœ»í•¨, ëˆì í•¨, ë“œë¼ì´í•¨
  
  ì—¬ìš´ (ë’·ë§›):
    - ê¹”ë”í•œ ë, ê¸´ ì—¬ìš´, ë‹¨ ì—¬ìš´, ì“´ ì—¬ìš´
    - ìƒì¾Œí•œ ë, ë”°ëœ»í•œ ë, ì‹œì›í•œ ë
```

#### Cafe Mode UI íŒ¨í„´
```typescript
interface CafeModeStep3 {
  sensory_expression: {
    aroma: string[]           // ìµœëŒ€ 3ê°œ ì„ íƒ
    flavor: string[]          // ìµœëŒ€ 4ê°œ ì„ íƒ  
    body: string[]            // ìµœëŒ€ 2ê°œ ì„ íƒ
    finish: string[]          // ìµœëŒ€ 2ê°œ ì„ íƒ
  }
  emotional_connection?: {
    mood: 'happy' | 'calm' | 'energetic' | 'cozy' | 'focused'
    situation: string         // "ì¹œêµ¬ì™€ ëŒ€í™”í•˜ë©°", "í˜¼ì ì±… ì½ìœ¼ë©°"
  }
}

// ì¼ìƒ ì–¸ì–´ ë””ìŠ¤í¬ë¦½í„°
const CAFE_DESCRIPTORS = {
  aroma: {
    category: 'ì²«ì¸ìƒ í–¥ê¸°',
    icon: 'ğŸŒ¸',
    options: [
      { id: 'sweet_aroma', label: 'ë‹¬ì½¤í•œ í–¥', description: 'ì„¤íƒ•ì´ë‚˜ ê¿€ ê°™ì€' },
      { id: 'nutty_aroma', label: 'ê³ ì†Œí•œ í–¥', description: 'ê²¬ê³¼ë¥˜ ê°™ì€' },
      { id: 'floral', label: 'ê½ƒí–¥ê¸°', description: 'ì¥ë¯¸ë‚˜ ììŠ¤ë¯¼ ê°™ì€' },
      { id: 'fruity_aroma', label: 'ê³¼ì¼í–¥ê¸°', description: 'ì‚¬ê³¼ë‚˜ ì˜¤ë Œì§€ ê°™ì€' },
      { id: 'fresh', label: 'ìƒí¼í•œ í–¥', description: 'ë ˆëª¬ì´ë‚˜ ë¯¼íŠ¸ ê°™ì€' },
      { id: 'smoky', label: 'ìŠ¤ëª¨í‚¤í•œ í–¥', description: 'êµ¬ìš´ ëƒ„ìƒˆ' },
      { id: 'earthy', label: 'í™ë‚´ìŒ', description: 'ìì—°ìŠ¤ëŸ¬ìš´ í™ ëƒ„ìƒˆ' },
      { id: 'roasted', label: 'êµ¬ìš´ í–¥', description: 'í† ìŠ¤íŠ¸ë‚˜ ê²¬ê³¼ë¥˜' }
    ]
  },
  // ... ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬ë“¤
}
```

### ğŸ  HomeCafe Mode: ë ˆì‹œí”¼ ì—°ê²° í‘œí˜„

#### ì¶”ì¶œ ë°©ë²•ê³¼ ê°ê°ì˜ ì—°ê²°
```yaml
Screen Philosophy:
  - "ë‚´ê°€ ë§Œë“  ì»¤í”¼ëŠ” ì–´ë• ë‚˜ìš”?"
  - ì¶”ì¶œ ì¡°ê±´ê³¼ ë§›ì˜ ê´€ê³„ í•™ìŠµ
  - ë‹¤ìŒ ì¶”ì¶œ ê°œì„ ì  ì œì•ˆ

Recipe Connection:
  ì¶”ì¶œ ê²°ê³¼ ë¶„ì„:
    - ë“œë¦¬í¼ë³„ íŠ¹ì„± ë°˜ì˜
    - ë¹„ìœ¨/ì˜¨ë„ì™€ ë§›ì˜ ì—°ê²°
    - "ë” ë‹¬ê²Œ í•˜ë ¤ë©´?" ì œì•ˆ
  
  Learning Feedback:
    - ê³¼ì¶”ì¶œ/ë¯¸ì¶”ì¶œ íŒì •
    - ê°œì„  ë°©í–¥ ì œì‹œ
    - ë ˆì‹œí”¼ ì¡°ì • ê°€ì´ë“œ
```

#### HomeCafe íŠ¹í™” ì¸í„°í˜ì´ìŠ¤
```typescript
interface HomeCafeModeStep3 {
  sensory_expression: {
    aroma: SCADescriptor[]    // SCA ì—°ê²° ì˜µì…˜
    flavor: SCADescriptor[]
    body: SCADescriptor[]
    finish: SCADescriptor[]
  }
  extraction_evaluation: {
    balance: 'under' | 'optimal' | 'over'    // ì¶”ì¶œ ê· í˜•
    target_adjustment?: {
      grind_size: 'finer' | 'coarser' | 'same'
      water_temp: 'higher' | 'lower' | 'same'
      brew_time: 'longer' | 'shorter' | 'same'
    }
  }
  recipe_notes?: string     // ë‹¤ìŒ ì‹œë„ë¥¼ ìœ„í•œ ë©”ëª¨
}

// SCA ì—°ê²° ë””ìŠ¤í¬ë¦½í„° (ì¤‘ê°„ ë³µì¡ë„)
const HOMECAFE_DESCRIPTORS = {
  aroma: {
    category: 'í–¥ (Aroma)',
    learningTips: true,
    options: [
      { 
        id: 'floral', 
        label: 'ê½ƒí–¥ê¸°', 
        sca_term: 'Floral',
        description: 'ììŠ¤ë¯¼, ì¥ë¯¸ ê°™ì€ í–¥ê¸°',
        brewing_note: 'V60ì—ì„œ ì˜ ë‚˜íƒ€ë‚¨'
      },
      {
        id: 'fruity',
        label: 'ê³¼ì¼í–¥',
        sca_term: 'Fruity',
        description: 'ë² ë¦¬, ì‹œíŠ¸ëŸ¬ìŠ¤ ê³„ì—´',
        brewing_note: 'ë‚®ì€ ì˜¨ë„ì—ì„œ ê°•ì¡°ë¨'
      }
      // ... ë” ë§ì€ ì˜µì…˜
    ]
  }
}
```

### ğŸ”¬ Pro Mode: SCA í‘œì¤€ í‰ê°€

#### ì „ë¬¸ íí•‘ í”„ë¡œí† ì½œ
```yaml
Screen Philosophy:
  - SCA Cupping Protocol ì¤€ìˆ˜
  - ê°ê´€ì  í‰ê°€ ê¸°ì¤€
  - ì ìˆ˜í™” ê°€ëŠ¥í•œ ë°ì´í„°

SCA Standard Categories:
  Fragrance/Aroma (í–¥ë¯¸):
    - Dry Fragrance (ë“œë¼ì´ í–¥)
    - Wet Aroma (ì –ì€ í–¥)
    - 1-10ì  ìŠ¤ì¼€ì¼
  
  Flavor (í”Œë ˆì´ë²„):
    - 85ê°œ SCA Flavor Wheel ë””ìŠ¤í¬ë¦½í„°
    - Intensity ê°•ë„ (1-5)
    - Quality í’ˆì§ˆ (1-10)
  
  Body (ë°”ë””):
    - Light, Medium-Light, Medium, Medium-Full, Full
    - Texture ì§ˆê° í‰ê°€
  
  Acidity (ì‚°ë¯¸):
    - Intensity: Low, Medium-Low, Medium, Medium-High, High
    - Quality: Brightness, Liveliness, Sourness êµ¬ë¶„
  
  Finish (í”¼ë‹ˆì‹œ):
    - Length: Short, Medium, Long
    - Quality: Clean, Lingering, Astringent
    - Aftertaste íŠ¹ì„± ê¸°ë¡
```

#### Pro Mode ì „ë¬¸ ì¸í„°í˜ì´ìŠ¤
```typescript
interface ProModeStep3 {
  sca_evaluation: {
    fragrance_aroma: {
      dry_fragrance: {
        descriptors: string[]   // SCA Wheel ê¸°ì¤€
        intensity: number       // 1-10
        quality: number        // 1-10
      }
      wet_aroma: {
        descriptors: string[]
        intensity: number
        quality: number
      }
    }
    flavor: {
      primary_descriptors: string[]    // ì£¼ìš” 3-5ê°œ
      secondary_descriptors: string[]  // ë³´ì¡° í–¥ë¯¸
      intensity: number               // 1-10
      quality: number                // 1-10
    }
    body: {
      weight: 'light' | 'medium-light' | 'medium' | 'medium-full' | 'full'
      texture: string[]              // Creamy, Silky, Juicy ë“±
      intensity: number              // 1-10
    }
    acidity: {
      intensity: 'low' | 'medium-low' | 'medium' | 'medium-high' | 'high'
      quality: 'bright' | 'lively' | 'sour' | 'tart' | 'malic'
      score: number                  // 1-10
    }
    finish: {
      length: 'short' | 'medium' | 'long'
      quality: 'clean' | 'lingering' | 'astringent'
      aftertaste_descriptors: string[]
      score: number                  // 1-10
    }
  }
  overall_impression: {
    balance: number                   // 1-10
    sweetness: number                // 1-10
    uniformity: number               // 1-10 (ì¼ê´€ì„±)
    clean_cup: number                // 1-10 (ê¹”ë”í•¨)
    overall: number                  // 1-10
  }
  cupping_notes?: string            // ì „ë¬¸ê°€ ë©”ëª¨
}

// SCA í‘œì¤€ ë””ìŠ¤í¬ë¦½í„° (ì „ì²´ 85ê°œ)
const SCA_FLAVOR_WHEEL = {
  fruity: {
    berry: ['blackberry', 'raspberry', 'blueberry', 'strawberry'],
    dried_fruit: ['raisin', 'prune', 'fig', 'date'],
    other_fruit: ['coconut', 'cherry', 'pomegranate', 'pineapple'],
    citrus_fruit: ['grapefruit', 'orange', 'lemon', 'lime']
  },
  // ... ì „ì²´ SCA Wheel êµ¬ì¡°
}
```

## ğŸ”„ ì¸í„°ë™ì…˜ í”Œë¡œìš°

### ë‹¨ê³„ë³„ ì„ íƒ í”„ë¡œì„¸ìŠ¤

```mermaid
graph TD
    A[Sensory Expression ì‹œì‘] --> B[4ê°œ ì¹´í…Œê³ ë¦¬ í‘œì‹œ]
    B --> C[í–¥ ì„ íƒ]
    C --> D[ë§› ì„ íƒ]
    D --> E[ì´‰ê° ì„ íƒ]
    E --> F[ì—¬ìš´ ì„ íƒ]
    F --> G{ëª¨ë“  í•„ìˆ˜ ì„ íƒ ì™„ë£Œ?}
    G -->|No| H[ë¯¸ì™„ë£Œ ì¹´í…Œê³ ë¦¬ í•˜ì´ë¼ì´íŠ¸]
    H --> C
    G -->|Yes| I[ì„ íƒ ê²°ê³¼ ìš”ì•½]
    I --> J[ë‹¤ìŒ ë‹¨ê³„ë¡œ]
```

### ëª¨ë“œë³„ ì„ íƒ íë¦„

#### Cafe Mode: ë¹ ë¥¸ ì§ê´€ ì„ íƒ
```typescript
// ì¹´í…Œê³ ë¦¬ë³„ ìˆœì°¨ ì„ íƒ
const CafeModeFlow = () => {
  const [currentCategory, setCurrentCategory] = useState(0)
  const categories = ['aroma', 'flavor', 'body', 'finish']
  
  const handleSelection = (categoryIndex: number, selections: string[]) => {
    updateSensoryData(categories[categoryIndex], selections)
    
    // ìë™ ë‹¤ìŒ ì¹´í…Œê³ ë¦¬ë¡œ
    if (categoryIndex < categories.length - 1) {
      setCurrentCategory(categoryIndex + 1)
    } else {
      // ëª¨ë“  ì„ íƒ ì™„ë£Œ
      showSummary()
    }
  }
  
  return (
    <div className="cafe-sensory-flow">
      <CategoryProgress current={currentCategory} total={4} />
      <SensoryCategory
        category={categories[currentCategory]}
        onSelect={(selections) => handleSelection(currentCategory, selections)}
        maxSelections={getMaxSelections(categories[currentCategory])}
      />
    </div>
  )
}
```

#### HomeCafe Mode: í•™ìŠµ ì¤‘ì‹¬ ì„ íƒ
```typescript
// ì¶”ì¶œ ê²°ê³¼ì™€ ì—°ê²°ëœ ì„ íƒ
const HomeCafeModeFlow = () => {
  const { recipe } = useStep2Data() // ì´ì „ ë‹¨ê³„ ë ˆì‹œí”¼ ì •ë³´
  
  const getBrewingContext = (descriptor: string) => {
    // ì¶”ì¶œ ì¡°ê±´ê³¼ ë§›ì˜ ì—°ê²° ì„¤ëª…
    const context = {
      dripper: recipe.dripper,
      ratio: recipe.ratio,
      temperature: recipe.water_temp
    }
    
    return generateBrewingAdvice(descriptor, context)
  }
  
  return (
    <div className="homecafe-sensory-flow">
      <RecipeContext recipe={recipe} />
      <SensoryCategories
        mode="homecafe"
        onSelect={handleHomeCafeSelection}
        brewingContext={getBrewingContext}
        showLearningTips={true}
      />
      <ExtractionAnalysis
        sensoryData={sensoryData}
        recipe={recipe}
        onAdjustmentSuggestion={handleAdjustmentSuggestion}
      />
    </div>
  )
}
```

#### Pro Mode: ì²´ê³„ì  SCA í‰ê°€
```typescript
// SCA íí•‘ ì‹œíŠ¸ ë°©ì‹
const ProModeFlow = () => {
  const [evaluationStep, setEvaluationStep] = useState('fragrance')
  const scaSteps = ['fragrance', 'aroma', 'flavor', 'body', 'acidity', 'finish', 'overall']
  
  return (
    <div className="pro-sensory-flow">
      <SCAProgressTracker current={evaluationStep} />
      <CuppingSheet
        step={evaluationStep}
        onComplete={(data) => {
          updateSCAData(evaluationStep, data)
          moveToNextStep()
        }}
        showSCAGuidelines={true}
      />
      <ScoreCalculator currentScores={scaData} />
    </div>
  )
}
```

## ğŸ¨ UI/UX ì„¤ê³„

### ê°ê° ì„ íƒ ì¸í„°í˜ì´ìŠ¤

#### íƒœê·¸ ê¸°ë°˜ ì„ íƒ ì‹œìŠ¤í…œ
```css
/* ê°ê° ë””ìŠ¤í¬ë¦½í„° íƒœê·¸ */
.sensory-tag {
  display: inline-block;
  padding: 0.5rem 1rem;
  margin: 0.25rem;
  border: 2px solid transparent;
  border-radius: 25px;
  background: var(--coffee-cream);
  color: var(--coffee-dark);
  cursor: pointer;
  transition: all 0.2s ease;
  
  /* í„°ì¹˜ ìµœì í™” */
  min-height: 44px;
  min-width: 80px;
}

.sensory-tag:hover {
  background: var(--coffee-light);
  transform: translateY(-1px);
}

.sensory-tag.selected {
  background: var(--coffee-accent);
  border-color: var(--coffee-primary);
  color: white;
  font-weight: 600;
}

.sensory-tag.selected::after {
  content: "âœ“";
  margin-left: 0.5rem;
}
```

#### ì¹´í…Œê³ ë¦¬ë³„ ì§„í–‰ í‘œì‹œ
```typescript
// ì§„í–‰ë¥  ì»´í¬ë„ŒíŠ¸
const SensoryProgress = ({ categories, current, completed }: {
  categories: string[]
  current: number
  completed: boolean[]
}) => {
  return (
    <div className="sensory-progress">
      {categories.map((category, index) => (
        <div 
          key={category}
          className={`progress-step ${
            index === current ? 'current' : 
            completed[index] ? 'completed' : 'pending'
          }`}
        >
          <div className="step-icon">
            {completed[index] ? 'âœ“' : getCategoryIcon(category)}
          </div>
          <div className="step-label">{getCategoryLabel(category)}</div>
        </div>
      ))}
    </div>
  )
}
```

### ëª¨ë“œë³„ ì‹œê°ì  ì°¨ë³„í™”

```css
/* Cafe Mode - ë”°ëœ»í•˜ê³  ì¹œê·¼í•œ ëŠë‚Œ */
.cafe-mode .sensory-container {
  background: linear-gradient(135deg, #FFF8F0 0%, #F5F0E8 100%);
  --accent-color: #D2691E;
}

/* HomeCafe Mode - ì‹¤í—˜ì ì´ê³  í•™ìŠµì ì¸ ëŠë‚Œ */
.homecafe-mode .sensory-container {
  background: linear-gradient(135deg, #F0F8F0 0%, #E8F5E8 100%);
  --accent-color: #228B22;
}

/* Pro Mode - ì „ë¬¸ì ì´ê³  ì •ë°€í•œ ëŠë‚Œ */
.pro-mode .sensory-container {
  background: linear-gradient(135deg, #F8F0FF 0%, #F0E8FF 100%);
  --accent-color: #6A5ACD;
}
```

## ğŸ”§ ê¸°ìˆ  êµ¬í˜„

### React ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜

```typescript
// app/record/step3/page.tsx
export default function SensoryExpressionPage() {
  const { currentSession, updateStep3 } = useCoffeeRecordStore()
  const mode = currentSession.mode
  const [sensoryData, setSensoryData] = useState<Step3Data>({
    mode,
    sensory_expression: {}
  })

  const renderModeSpecificContent = () => {
    switch (mode) {
      case 'cafe':
        return (
          <CafeModeSensory
            data={sensoryData}
            onChange={setSensoryData}
            onComplete={handleComplete}
          />
        )
      case 'homecafe':
        return (
          <HomeCafeModeSensory
            data={sensoryData}
            recipe={currentSession.step2_data}
            onChange={setSensoryData}
            onComplete={handleComplete}
          />
        )
      case 'pro':
        return (
          <ProModeSensory
            data={sensoryData}
            onChange={setSensoryData}
            onComplete={handleComplete}
          />
        )
    }
  }

  const handleComplete = () => {
    updateStep3(sensoryData)
    router.push('/record/step4')
  }

  return (
    <ProtectedRoute>
      <div className={`sensory-expression-container ${mode}-mode`}>
        <StepHeader 
          step={3} 
          progress={75}
          mode={mode}
          title={getStepTitle(mode)}
          description={getStepDescription(mode)}
        />
        
        {renderModeSpecificContent()}
        
        <StepNavigation
          onPrevious={() => router.push('/record/step2')}
          onNext={validateAndNext}
          canGoNext={isStepComplete(sensoryData)}
          nextLabel="ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ"
        />
      </div>
    </ProtectedRoute>
  )
}
```

### ê°ê° ë°ì´í„° ê²€ì¦ ì‹œìŠ¤í…œ

```typescript
// validation/sensoryValidation.ts
export const sensoryValidationRules: Record<CoffeeMode, ValidationRules> = {
  cafe: {
    required: ['aroma', 'flavor'],
    optional: ['body', 'finish'],
    constraints: {
      aroma: { maxSelections: 3, minSelections: 1 },
      flavor: { maxSelections: 4, minSelections: 2 },
      body: { maxSelections: 2, minSelections: 0 },
      finish: { maxSelections: 2, minSelections: 0 }
    }
  },
  
  homecafe: {
    required: ['aroma', 'flavor', 'extraction_evaluation'],
    optional: ['body', 'finish', 'recipe_notes'],
    constraints: {
      aroma: { maxSelections: 4, minSelections: 2 },
      flavor: { maxSelections: 5, minSelections: 3 },
      extraction_evaluation: { required: ['balance'] }
    }
  },
  
  pro: {
    required: [
      'fragrance_aroma', 'flavor', 'body', 'acidity', 'finish', 'overall_impression'
    ],
    optional: ['cupping_notes'],
    constraints: {
      flavor: { minDescriptors: 3, maxDescriptors: 8 },
      overall_impression: { allScoresRequired: true }
    }
  }
}

export const validateSensoryData = (data: Step3Data): ValidationResult => {
  const rules = sensoryValidationRules[data.mode]
  const errors: string[] = []
  
  // í•„ìˆ˜ í•„ë“œ ê²€ì¦
  rules.required.forEach(field => {
    if (!data.sensory_expression[field] || 
        (Array.isArray(data.sensory_expression[field]) && 
         data.sensory_expression[field].length === 0)) {
      errors.push(`${field}ëŠ” í•„ìˆ˜ ì„ íƒ í•­ëª©ì…ë‹ˆë‹¤`)
    }
  })
  
  // ì œì•½ ì¡°ê±´ ê²€ì¦
  Object.entries(rules.constraints || {}).forEach(([field, constraint]) => {
    const fieldData = data.sensory_expression[field]
    
    if (Array.isArray(fieldData)) {
      if (constraint.minSelections && fieldData.length < constraint.minSelections) {
        errors.push(`${field}ëŠ” ìµœì†Œ ${constraint.minSelections}ê°œ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤`)
      }
      if (constraint.maxSelections && fieldData.length > constraint.maxSelections) {
        errors.push(`${field}ëŠ” ìµœëŒ€ ${constraint.maxSelections}ê°œë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤`)
      }
    }
  })
  
  return {
    isValid: errors.length === 0,
    errors
  }
}
```

## ğŸ“Š ì„±ê³¼ ì§€í‘œ

### ì‚¬ìš©ì„± ë©”íŠ¸ë¦­
- **ì™„ë£Œ ì‹œê°„**: Cafe 2ë¶„, HomeCafe 4ë¶„, Pro 8ë¶„ ëª©í‘œ
- **ì„ íƒ ì •í™•ë„**: ì‚¬ìš©ì ë§Œì¡±ë„ ê¸°ë°˜ ì¬ì„ íƒë¥  <10%
- **í•™ìŠµ íš¨ê³¼**: HomeCafe ëª¨ë“œ ê°œì„  ì œì•ˆ í™œìš©ë¥  >60%

### ë°ì´í„° í’ˆì§ˆ
- **ë””ìŠ¤í¬ë¦½í„° ë‹¤ì–‘ì„±**: ì‚¬ìš©ìë‹¹ í‰ê·  ì‚¬ìš© ë””ìŠ¤í¬ë¦½í„° ìˆ˜
- **SCA í‘œì¤€ ì¤€ìˆ˜ìœ¨**: Pro ëª¨ë“œ ì „ë¬¸ ìš©ì–´ ì‚¬ìš© ë¹„ìœ¨
- **ì¼ê´€ì„± ì ìˆ˜**: ê°™ì€ ì»¤í”¼ ë°˜ë³µ ê¸°ë¡ ì‹œ ì¼ê´€ì„±

---

**ğŸ“… ë¬¸ì„œ ìƒì„±**: 2025-07-31  
**ì²´í¬í¬ì¸íŠ¸ ê¸°ë°˜**: 7/29 ê°ê° í‘œí˜„ 4ê°œ ì¹´í…Œê³ ë¦¬ ë‹¨ìˆœí™”  
**êµ¬í˜„ ìƒíƒœ**: v1.0.0-rc, ëª¨ë“œë³„ ì°¨ë³„í™” ì™„ë£Œ