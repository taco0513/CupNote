# Personal Notes & Result Screen (Step4)

## ğŸ¯ í™”ë©´ ê°œìš”

TastingFlowì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ, ê°œì¸ì ì¸ ë©”ëª¨ë¥¼ ì¶”ê°€í•˜ê³  ì „ì²´ ê²°ê³¼ë¥¼ í™•ì¸í•˜ëŠ” í™”ë©´ì…ë‹ˆë‹¤. ëª¨ë“œë³„ë¡œ ë‹¤ë¥¸ ê²°ê³¼ í‘œì‹œì™€ ì €ì¥ ì˜µì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.

### í™”ë©´ ìœ„ì¹˜
- **ë¼ìš°íŒ…**: `/record/step4`
- **ì§„í–‰ë¥ **: 100% (4/4)
- **ì´ì „ í™”ë©´**: Sensory Expression (Step3)
- **ë‹¤ìŒ í™”ë©´**: ì™„ë£Œ í›„ í™ˆ ë˜ëŠ” ê¸°ë¡ ìƒì„¸ë³´ê¸°

## ğŸ§© í™”ë©´ êµ¬ì„± ì² í•™

### 7/29 ì²´í¬í¬ì¸íŠ¸ ê¸°ë°˜ ì„¤ê³„ ì›ì¹™

#### PersonalNotesView ê°œì„ ì‚¬í•­
```yaml
Smart Memo System:
  - ì´ì „ ì„ íƒì‚¬í•­ í™œìš©: "í´ë¦­ìœ¼ë¡œ ë¬¸ì¥ ì™„ì„±"
  - ìì—°ìŠ¤ëŸ¬ìš´ ë©”ëª¨: ì¡°ì‚¬ ìë™ ì²˜ë¦¬
  - ë¹ ë¥¸ ì…ë ¥: ë²„íŠ¼ í˜•íƒœë¡œ ì´ì „ ì„ íƒ í‘œì‹œ
  - ìŠ¤ë§ˆíŠ¸ ì¶”ì²œ: ë§¥ë½ ê¸°ë°˜ ì œì•ˆ

Interactive Features:
  - ì„ íƒ ê²°ê³¼ â†’ ë©”ëª¨ ìë™ ë³€í™˜
  - í•œêµ­ì–´ ìì—°ì–´ ì²˜ë¦¬
  - ê°œì¸í™”ëœ í‘œí˜„ í•™ìŠµ
  - ë°˜ë³µ ì‚¬í•­ ìë™ ì™„ì„±
```

#### ê°œì¸ ë©”ëª¨ vs ë¡œìŠ¤í„° ë…¸íŠ¸ ë¶„ë¦¬
```yaml
Personal Notes (í•„ìˆ˜):
  - ë‚˜ë§Œì˜ ê°ìƒ
  - ì£¼ê´€ì  ê²½í—˜
  - ìƒí™©ì  ë§¥ë½
  - ë‹¤ìŒì„ ìœ„í•œ ë©”ëª¨

Roaster Notes (ì„ íƒì‚¬í•­):
  - ë¡œìŠ¤í„°ì˜ ê³µì‹ ì„¤ëª…
  - 3ê°€ì§€ ì…ë ¥ ë°©ì‹
    - í…ìŠ¤íŠ¸ ì§ì ‘ ì…ë ¥
    - ì‚¬ì§„ ì´¬ì˜
    - ê±´ë„ˆë›°ê¸°
```

## ğŸ¨ ëª¨ë“œë³„ í™”ë©´ êµ¬ì„±

### â˜• Cafe Mode: ê°„ë‹¨í•œ íšŒê³ ì™€ ì €ì¥

#### ì²´í¬í¬ì¸íŠ¸ ë°˜ì˜ - ê°ì •ì  ì—°ê²° ì¤‘ì‹¬
```yaml
Screen Focus:
  - "ì˜¤ëŠ˜ ì»¤í”¼ ì–´ë– ì…¨ë‚˜ìš”?" ì ‘ê·¼
  - ê°ì •ê³¼ ìƒí™©ì˜ ê¸°ë¡
  - ë¹ ë¥¸ ì €ì¥ (1ë¶„ ëª©í‘œ)

Content Structure:
  Personal Reflection:
    - ì „ì²´ì ì¸ ë§Œì¡±ë„ (ë³„ì )
    - ì˜¤ëŠ˜ì˜ ê¸°ë¶„ê³¼ ì—°ê²°
    - í•¨ê»˜í•œ ì‚¬ëŒì´ë‚˜ ìƒí™©
    - ê°„ë‹¨í•œ í•œ ì¤„ ê°ìƒ
  
  Quick Save Options:
    - "ì¦ê±°ìš´ ì‹œê°„ì´ì—ˆì–´ìš”" ë²„íŠ¼
    - "ìƒˆë¡œìš´ ë§›ì´ì—ˆì–´ìš”" ë²„íŠ¼
    - "ë‹¤ì‹œ ë§ˆì‹œê³  ì‹¶ì–´ìš”" ë²„íŠ¼
    - ì»¤ìŠ¤í…€ ë©”ëª¨ ì…ë ¥
  
  Context Memory:
    - ì¹´í˜ ë¶„ìœ„ê¸° ê¸°ë¡
    - ë‚ ì”¨ë‚˜ ì‹œê°„ëŒ€
    - íŠ¹ë³„í•œ ìˆœê°„ë“¤
```

#### Cafe Mode ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°
```typescript
interface CafeModeStep4 {
  personal_notes: {
    overall_satisfaction: number      // 1-5 ë³„ì 
    mood_connection: string          // ê°ì • ì—°ê²°
    situation_context: string        // ìƒí™© ë§¥ë½
    quick_reflection: string         // í•œ ì¤„ ê°ìƒ
    memorable_moment?: string        // íŠ¹ë³„í•œ ìˆœê°„
  }
  save_preferences: {
    add_to_favorites: boolean        // ì¦ê²¨ì°¾ê¸° ì¶”ê°€
    share_with_friends: boolean      // ì¹œêµ¬ë“¤ê³¼ ê³µìœ 
    set_reminder: boolean           // ì¬ë°©ë¬¸ ì•Œë¦¼
  }
  roaster_notes?: {
    source: 'text' | 'photo' | 'skip'
    content?: string
    photo_url?: string
  }
}

// ìŠ¤ë§ˆíŠ¸ ë©”ëª¨ ìë™ ì™„ì„±
const CAFE_QUICK_TEMPLATES = {
  satisfaction_high: [
    "ì •ë§ ë§›ìˆì—ˆì–´ìš”! {flavor_tags}ê°€ ì¸ìƒì ì´ì—ˆë„¤ìš”.",
    "{cafe_name}ì—ì„œ ë§ˆì‹  {coffee_name}, ë˜ ë§ˆì‹œê³  ì‹¶ì–´ìš”.",
    "ì˜¤ëŠ˜ {situation}í•˜ë©° ë§ˆì‹  ì»¤í”¼ê°€ ë”± ì¢‹ì•˜ì–´ìš”."
  ],
  satisfaction_medium: [
    "{coffee_name} ë‚˜ì˜ì§€ ì•Šì•˜ì–´ìš”. {flavor_tags} ë§›ì´ ë‚¬ì–´ìš”.",
    "ê´œì°®ì€ ì»¤í”¼ì˜€ì–´ìš”. ë‹¤ìŒì—” ë‹¤ë¥¸ ê²ƒë„ ì‹œë„í•´ë³¼ê²Œìš”."
  ],
  satisfaction_low: [
    "ì´ë²ˆì—” ì œ ì·¨í–¥ì´ ì•„ë‹ˆì—ˆë„¤ìš”. í•˜ì§€ë§Œ ê²½í—˜ì´ ë˜ì—ˆì–´ìš”.",
    "ë‹¤ìŒì—” {alternative_suggestion}ì„ ì‹œë„í•´ë³´ê² ì–´ìš”."
  ]
}
```

### ğŸ  HomeCafe Mode: ë ˆì‹œí”¼ íšŒê³ ì™€ ê°œì„ ì 

#### ì¶”ì¶œ ê²°ê³¼ ë¶„ì„ê³¼ í•™ìŠµ
```yaml
Screen Focus:
  - "ì˜¤ëŠ˜ ì¶”ì¶œì€ ì–´ë– ì…¨ë‚˜ìš”?"
  - ë ˆì‹œí”¼ì™€ ê²°ê³¼ì˜ ì—°ê²°
  - ë‹¤ìŒ ì¶”ì¶œ ê°œì„ ì 

Brewing Analysis:
  ì¶”ì¶œ ì„±ê³µë„:
    - ëª©í‘œ ë‹¬ì„±: "ìƒê°í–ˆë˜ ëŒ€ë¡œ ë‚˜ì™”ë‚˜ìš”?"
    - ê°œì„  ì—¬ì§€: "ë‹¤ìŒì—” ë­˜ ë°”ê¿”ë³¼ê¹Œìš”?"
    - ìš°ì—°í•œ ë°œê²¬: "ì˜ˆìƒê³¼ ë‹¤ë¥¸ ì¢‹ì€ ì "
  
  Recipe Notes:
    - ì˜¤ëŠ˜ì˜ ì„¤ì • í‰ê°€
    - ë‹¤ìŒ ì‹œë„ ê³„íš
    - ì¥ë¹„ë‚˜ í™˜ê²½ íŠ¹ì´ì‚¬í•­
  
  Learning Tracking:
    - ì„±ê³µ í¬ì¸íŠ¸ ê¸°ë¡
    - ì‹¤íŒ¨ ìš”ì¸ ë¶„ì„
    - ê°œì¸ ë ˆì‹œí”¼ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•
```

#### HomeCafe Mode íŠ¹í™” ê¸°ëŠ¥
```typescript
interface HomeCafeModeStep4 {
  brewing_reflection: {
    target_achievement: 'exceeded' | 'met' | 'close' | 'missed'  // ëª©í‘œ ë‹¬ì„±ë„
    satisfaction_rating: number                                    // 1-10
    unexpected_discovery?: string                                  // ì˜ˆìƒ ì™¸ ë°œê²¬
  }
  recipe_evaluation: {
    what_worked: string[]           // ì„±ê³µ ìš”ì†Œ
    what_to_improve: string[]       // ê°œì„ ì 
    next_experiment: {
      parameter: 'grind' | 'ratio' | 'temperature' | 'time'
      direction: 'increase' | 'decrease' | 'change'
      reasoning: string
    }
  }
  personal_recipe: {
    save_as_favorite: boolean       // ê°œì¸ ë ˆì‹œí”¼ë¡œ ì €ì¥
    recipe_name?: string           // ë ˆì‹œí”¼ ì´ë¦„
    sharing_notes?: string         // ë‹¤ë¥¸ ì‚¬ëŒë“¤ì„ ìœ„í•œ íŒ
  }
  roaster_notes?: RoasterNotesData
}

// ì¶”ì¶œ ë¶„ì„ ìë™ ìƒì„±
const generateBrewingInsights = (step2Data: any, step3Data: any): string[] => {
  const insights: string[] = []
  
  // ë“œë¦¬í¼ë³„ íŠ¹ì„± ë°˜ì˜
  if (step2Data.dripper === 'v60') {
    insights.push('V60ì˜ ê¹”ë”í•œ íŠ¹ì„±ì´ ì˜ ë‚˜íƒ€ë‚¬ë„¤ìš”')
  }
  
  // ë¹„ìœ¨ê³¼ ë§›ì˜ ì—°ê²°
  if (step2Data.ratio <= 15.5 && step3Data.body?.includes('ì§„í•œ')) {
    insights.push('ì§„í•œ ë¹„ìœ¨ ì„¤ì •ì´ ë°”ë””ê°ì— ì˜ ë°˜ì˜ë˜ì—ˆì–´ìš”')
  }
  
  // ì˜¨ë„ì™€ í–¥ë¯¸ì˜ ì—°ê²°
  if (step2Data.water_temp >= 95 && step3Data.aroma?.includes('ë¡œìŠ¤í‹°')) {
    insights.push('ë†’ì€ ì˜¨ë„ë¡œ ë¡œìŠ¤íŒ… í–¥ì´ ì˜ ì¶”ì¶œë˜ì—ˆë„¤ìš”')
  }
  
  return insights
}
```

### ğŸ”¬ Pro Mode: ì „ë¬¸ í‰ê°€ ë¦¬í¬íŠ¸

#### SCA í‘œì¤€ ê²°ê³¼ ë¦¬í¬íŠ¸
```yaml
Screen Focus:
  - SCA íí•‘ ìŠ¤ì½”ì–´ ê³„ì‚°
  - ì „ë¬¸ê°€ ìˆ˜ì¤€ ë¶„ì„ ë¦¬í¬íŠ¸
  - í’ˆì§ˆ ê°œì„  ì œì–¸

SCA Scoring:
  Total Score Calculation:
    - Fragrance/Aroma: ___/10
    - Flavor: ___/10
    - Aftertaste: ___/10
    - Body: ___/10
    - Balance: ___/10
    - Overall: ___/10
    - Total: ___/100
  
  Quality Classification:
    - 90-100: Outstanding
    - 85-89.99: Excellent
    - 80-84.99: Very Good
    - 75-79.99: Good
    - 70-74.99: Fair
    - <70: Poor
  
  Professional Notes:
    - ê°•ì  ë¶„ì„
    - ê°œì„  ì˜ì—­
    - ë¡œìŠ¤íŒ… ì¶”ì²œ
    - ì¶”ì¶œ ì¡°ì • ì œì•ˆ
```

#### Pro Mode ì „ë¬¸ ë¶„ì„ ì‹œìŠ¤í…œ
```typescript
interface ProModeStep4 {
  sca_final_score: {
    total_score: number             // 0-100
    category_scores: {
      fragrance_aroma: number       // 0-10
      flavor: number               // 0-10
      aftertaste: number           // 0-10
      body: number                 // 0-10
      balance: number              // 0-10
      overall: number              // 0-10
    }
    quality_grade: 'outstanding' | 'excellent' | 'very_good' | 'good' | 'fair' | 'poor'
  }
  professional_analysis: {
    strengths: string[]             // ê°•ì  ë¶„ì„
    improvement_areas: string[]     // ê°œì„  ì˜ì—­
    roasting_feedback: {
      current_level: 'light' | 'medium-light' | 'medium' | 'medium-dark' | 'dark'
      recommended_adjustment?: 'lighter' | 'darker' | 'optimal'
      reasoning: string
    }
    brewing_recommendations: {
      grind_adjustment?: 'finer' | 'coarser'
      temperature_adjustment?: 'higher' | 'lower'
      extraction_time?: 'longer' | 'shorter'
      notes: string
    }
  }
  cupping_notes: {
    defects?: string[]              // ì»µ ê²°í•¨
    distinctive_characteristics: string[]  // íŠ¹ì§•ì  ìš”ì†Œ
    market_potential?: 'specialty' | 'commercial' | 'below_commercial'  // ì‹œì¥ì„± í‰ê°€
  }
  professional_memo: string         // ì „ë¬¸ê°€ ë©”ëª¨
}

// SCA ì ìˆ˜ ê³„ì‚° ë¡œì§
const calculateSCAScore = (evaluationData: any): number => {
  const weights = {
    fragrance_aroma: 1.0,
    flavor: 2.0,        // ê°€ì¤‘ì¹˜ ë†’ìŒ
    aftertaste: 1.0,
    body: 1.0,
    balance: 1.0,
    overall: 1.0
  }
  
  let totalScore = 0
  let totalWeight = 0
  
  Object.entries(weights).forEach(([category, weight]) => {
    const score = evaluationData[category]?.score || 0
    totalScore += score * weight
    totalWeight += weight
  })
  
  return Math.round((totalScore / totalWeight) * 10) // 100ì  ë§Œì ìœ¼ë¡œ í™˜ì‚°
}
```

## ğŸ”„ ìŠ¤ë§ˆíŠ¸ ë©”ëª¨ ì‹œìŠ¤í…œ

### ì¸í„°ë™í‹°ë¸Œ ë©”ëª¨ ìë™ ì™„ì„±

```typescript
// Smart Memo Generation System
class SmartMemoGenerator {
  constructor(private step1Data: any, private step2Data: any, private step3Data: any) {}
  
  generateQuickOptions(): string[] {
    const options: string[] = []
    
    // ì´ì „ ì„ íƒì‚¬í•­ ê¸°ë°˜ ë¬¸ì¥ ìƒì„±
    if (this.step3Data.sensory_expression?.flavor) {
      const flavors = this.step3Data.sensory_expression.flavor.slice(0, 2)
      options.push(`${flavors.join('ê³¼ ')} ë§›ì´ ì¸ìƒì ì´ì—ˆì–´ìš”.`)
    }
    
    // ëª¨ë“œë³„ ë§ì¶¤ ì˜µì…˜
    if (this.step1Data.mode === 'cafe') {
      options.push(`${this.step1Data.cafe_name}ì—ì„œ ë§ˆì‹  ${this.step1Data.coffee_name}, ê¸°ì–µì— ë‚¨ë„¤ìš”.`)
    }
    
    if (this.step1Data.mode === 'homecafe') {
      const dripper = this.step2Data.dripper
      options.push(`${dripper}ë¡œ ì¶”ì¶œí•œ ê²°ê³¼ê°€ ë§Œì¡±ìŠ¤ëŸ¬ì›Œìš”.`)
    }
    
    // ê°ì • ì—°ê²° ì˜µì…˜
    const moodOptions = [
      'í¸ì•ˆí•œ ì‹œê°„ì´ì—ˆì–´ìš”.',
      'ìƒˆë¡œìš´ ê²½í—˜ì´ì—ˆë„¤ìš”.',
      'ìƒê°ë³´ë‹¤ ì¢‹ì•˜ì–´ìš”.',
      'ë‹¤ìŒì— ë˜ ë§ˆì‹œê³  ì‹¶ì–´ìš”.'
    ]
    
    return [...options, ...moodOptions]
  }
  
  processNaturalLanguage(text: string): string {
    // í•œêµ­ì–´ ì¡°ì‚¬ ìë™ ì²˜ë¦¬
    return text
      .replace(/([ê°€-í£])ì´ì—ìš”/g, (match, char) => {
        const hasJongseong = (char.charCodeAt(0) - 0xAC00) % 28 !== 0
        return hasJongseong ? `${char}ì´ì—ìš”` : `${char}ì˜ˆìš”`
      })
      .replace(/([ê°€-í£])ì™€/g, (match, char) => {
        const hasJongseong = (char.charCodeAt(0) - 0xAC00) % 28 !== 0
        return hasJongseong ? `${char}ì™€` : `${char}ê³¼`
      })
  }
}
```

### ë²„íŠ¼ í˜•íƒœ ë©”ëª¨ ì…ë ¥

```typescript
// Interactive Memo Input Component
const InteractiveMemoInput = ({ 
  previousData, 
  onMemoUpdate 
}: {
  previousData: any
  onMemoUpdate: (memo: string) => void
}) => {
  const [currentMemo, setCurrentMemo] = useState('')
  const smartGenerator = new SmartMemoGenerator(previousData.step1, previousData.step2, previousData.step3)
  const quickOptions = smartGenerator.generateQuickOptions()
  
  const handleQuickSelect = (option: string) => {
    const processedText = smartGenerator.processNaturalLanguage(option)
    const newMemo = currentMemo ? `${currentMemo} ${processedText}` : processedText
    setCurrentMemo(newMemo)
    onMemoUpdate(newMemo)
  }
  
  return (
    <div className="interactive-memo-input">
      <div className="memo-display">
        <textarea
          value={currentMemo}
          onChange={(e) => {
            setCurrentMemo(e.target.value)
            onMemoUpdate(e.target.value)
          }}
          placeholder="ì˜¤ëŠ˜ì˜ ì»¤í”¼ëŠ” ì–´ë– ì…¨ë‚˜ìš”? ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë¹ ë¥´ê²Œ ì‘ì„±í•´ë³´ì„¸ìš”!"
          className="memo-textarea"
        />
      </div>
      
      <div className="quick-options">
        <h4>ë¹ ë¥¸ ì…ë ¥</h4>
        <div className="option-buttons">
          {quickOptions.map((option, index) => (
            <button
              key={index}
              onClick={() => handleQuickSelect(option)}
              className="option-btn"
            >
              {option}
            </button>
          ))}
        </div>
      </div>
      
      <div className="smart-suggestions">
        <h4>ë§ì¶¤ ì œì•ˆ</h4>
        <SmartSuggestions 
          context={previousData}
          onSelect={handleQuickSelect}
        />
      </div>
    </div>
  )
}
```

## ğŸ“Š ê²°ê³¼ ì‹œê°í™”

### ëª¨ë“œë³„ ê²°ê³¼ í‘œì‹œ

#### Cafe Mode: ê°ì • ì¤‘ì‹¬ ìš”ì•½
```typescript
const CafeModeResult = ({ sessionData }: { sessionData: CoffeeSession }) => {
  return (
    <div className="cafe-result-summary">
      <div className="satisfaction-display">
        <StarRating rating={sessionData.step4_data.overall_satisfaction} size="large" />
        <h3>ì˜¤ëŠ˜ì˜ ì»¤í”¼ ì‹œê°„</h3>
      </div>
      
      <div className="memory-card">
        <div className="coffee-info">
          <h4>{sessionData.step1_data.cafe_name}</h4>
          <p>{sessionData.step1_data.coffee_name}</p>
        </div>
        <div className="mood-display">
          <MoodIcon mood={sessionData.step4_data.mood_connection} />
          <p>{sessionData.step4_data.quick_reflection}</p>
        </div>
      </div>
      
      <div className="flavor-highlights">
        <h4>ê¸°ì–µì— ë‚¨ëŠ” ë§›</h4>
        <FlavorTagCloud tags={sessionData.step3_data.sensory_expression.flavor} />
      </div>
    </div>
  )
}
```

#### HomeCafe Mode: ë ˆì‹œí”¼ ì„±ê³¼ ë¦¬í¬íŠ¸
```typescript
const HomeCafeModeResult = ({ sessionData }: { sessionData: CoffeeSession }) => {
  const insights = generateBrewingInsights(sessionData.step2_data, sessionData.step3_data)
  
  return (
    <div className="homecafe-result-summary">
      <div className="brewing-score">
        <CircularProgress 
          value={sessionData.step4_data.satisfaction_rating * 10} 
          label="ì¶”ì¶œ ë§Œì¡±ë„"
        />
      </div>
      
      <div className="recipe-summary">
        <h4>ì˜¤ëŠ˜ì˜ ë ˆì‹œí”¼</h4>
        <RecipeCard recipe={sessionData.step2_data} compact />
      </div>
      
      <div className="insights-panel">
        <h4>ì¶”ì¶œ ë¶„ì„</h4>
        <InsightsList insights={insights} />
      </div>
      
      <div className="next-experiment">
        <h4>ë‹¤ìŒ ì‹¤í—˜</h4>
        <ExperimentSuggestion suggestion={sessionData.step4_data.next_experiment} />
      </div>
    </div>
  )
}
```

#### Pro Mode: SCA ì ìˆ˜ ë¦¬í¬íŠ¸
```typescript
const ProModeResult = ({ sessionData }: { sessionData: CoffeeSession }) => {
  const finalScore = sessionData.step4_data.sca_final_score
  
  return (
    <div className="pro-result-summary">
      <div className="sca-score-display">
        <div className="total-score">
          <span className="score-number">{finalScore.total_score}</span>
          <span className="score-suffix">/100</span>
          <p className="grade">{getGradeLabel(finalScore.quality_grade)}</p>
        </div>
      </div>
      
      <div className="category-breakdown">
        <h4>ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜</h4>
        <SCAScoreChart scores={finalScore.category_scores} />
      </div>
      
      <div className="professional-analysis">
        <div className="strengths">
          <h4>ê°•ì </h4>
          <ul>
            {sessionData.step4_data.professional_analysis.strengths.map((strength, i) => (
              <li key={i}>{strength}</li>
            ))}
          </ul>
        </div>
        
        <div className="improvements">
          <h4>ê°œì„  ì˜ì—­</h4>
          <ul>
            {sessionData.step4_data.professional_analysis.improvement_areas.map((area, i) => (
              <li key={i}>{area}</li>
            ))}
          </ul>
        </div>
      </div>
      
      <div className="recommendations">
        <h4>ì „ë¬¸ê°€ ì œì–¸</h4>
        <RecommendationPanel 
          roasting={sessionData.step4_data.professional_analysis.roasting_feedback}
          brewing={sessionData.step4_data.professional_analysis.brewing_recommendations}
        />
      </div>
    </div>
  )
}
```

## ğŸ”§ ê¸°ìˆ  êµ¬í˜„

### React ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜

```typescript
// app/record/step4/page.tsx
export default function PersonalNotesPage() {
  const router = useRouter()
  const { currentSession, updateStep4, completeSession } = useCoffeeRecordStore()
  const mode = currentSession.mode
  
  const [step4Data, setStep4Data] = useState<Step4Data>({
    mode,
    personal_notes: {},
    roaster_notes: { source: 'skip' }
  })
  
  const [showResult, setShowResult] = useState(false)
  const [saveOptions, setSaveOptions] = useState({
    addToFavorites: false,
    shareEnabled: false,
    setReminder: false
  })
  
  const handleComplete = async () => {
    // Step4 ë°ì´í„° ì—…ë°ì´íŠ¸
    updateStep4(step4Data)
    
    // ì „ì²´ ì„¸ì…˜ ì™„ë£Œ ì²˜ë¦¬
    const completedSession = await completeSession()
    
    // ê²°ê³¼ í™”ë©´ í‘œì‹œ
    setShowResult(true)
    
    // ìë™ ì €ì¥ ë° ë™ê¸°í™”
    if (completedSession) {
      await syncToDatabase(completedSession)
    }
  }
  
  const renderModeSpecificContent = () => {
    switch (mode) {
      case 'cafe':
        return (
          <CafeModeStep4
            data={step4Data}
            sessionData={currentSession}
            onChange={setStep4Data}
            onComplete={handleComplete}
          />
        )
      case 'homecafe':
        return (
          <HomeCafeModeStep4
            data={step4Data}
            sessionData={currentSession}
            onChange={setStep4Data}
            onComplete={handleComplete}
          />
        )
      case 'pro':
        return (
          <ProModeStep4
            data={step4Data}
            sessionData={currentSession}
            onChange={setStep4Data}
            onComplete={handleComplete}
          />
        )
    }
  }
  
  if (showResult) {
    return (
      <ResultScreen 
        session={currentSession}
        onNewRecord={() => router.push('/')}
        onViewHistory={() => router.push('/history')}
        onShare={() => handleShare(currentSession)}
      />
    )
  }
  
  return (
    <ProtectedRoute>
      <div className={`personal-notes-container ${mode}-mode`}>
        <StepHeader 
          step={4} 
          progress={100}
          mode={mode}
          title={getStepTitle(mode)}
          description={getStepDescription(mode)}
        />
        
        {renderModeSpecificContent()}
        
        <StepNavigation
          onPrevious={() => router.push('/record/step3')}
          onNext={handleComplete}
          canGoNext={isStepComplete(step4Data)}
          nextLabel="ì™„ë£Œ"
          showProgress={false}
        />
      </div>
    </ProtectedRoute>
  )
}
```

### ë°ì´í„° ì €ì¥ ë° ë™ê¸°í™”

```typescript
// services/coffeeRecordService.ts
export class CoffeeRecordService {
  static async saveCompleteSession(session: CoffeeSession): Promise<boolean> {
    try {
      // Supabaseì— ì €ì¥
      const { error } = await supabaseClient
        .from('coffee_records')
        .insert({
          user_id: session.user_id,
          mode: session.mode,
          step1_data: session.step1_data,
          step2_data: session.step2_data,
          step3_data: session.step3_data,
          step4_data: session.step4_data,
          completed_at: new Date().toISOString(),
          total_duration: session.duration,
          satisfaction_score: this.calculateSatisfactionScore(session)
        })
      
      if (error) throw error
      
      // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ë„ ë°±ì—…
      this.saveToLocalStorage(session)
      
      return true
    } catch (error) {
      console.error('Failed to save session:', error)
      return false
    }
  }
  
  static calculateSatisfactionScore(session: CoffeeSession): number {
    switch (session.mode) {
      case 'cafe':
        return session.step4_data.personal_notes.overall_satisfaction || 0
      case 'homecafe':
        return session.step4_data.brewing_reflection.satisfaction_rating || 0
      case 'pro':
        return session.step4_data.sca_final_score.total_score || 0
      default:
        return 0
    }
  }
  
  static saveToLocalStorage(session: CoffeeSession): void {
    const existingRecords = JSON.parse(localStorage.getItem('coffee_records') || '[]')
    existingRecords.push(session)
    localStorage.setItem('coffee_records', JSON.stringify(existingRecords))
  }
}
```

## ğŸ“ˆ ì„±ê³¼ ì§€í‘œ

### ì™„ë£Œìœ¨ ë©”íŠ¸ë¦­
- **Step4 ë„ë‹¬ë¥ **: ì „ì²´ ì‹œì‘ ëŒ€ë¹„ 80% ì´ìƒ
- **ì™„ë£Œìœ¨**: Step4 ì§„ì… í›„ 95% ì´ìƒ ì™„ë£Œ
- **ì¬ë°©ë¬¸ë¥ **: ì™„ë£Œ í›„ 7ì¼ ë‚´ ì¬ì‚¬ìš© 40% ì´ìƒ

### ë°ì´í„° í’ˆì§ˆ
- **ë©”ëª¨ ì‘ì„±ë¥ **: 60% ì´ìƒ (ë¹ˆ ë©”ëª¨ ë¹„ìœ¨ ìµœì†Œí™”)
- **ìŠ¤ë§ˆíŠ¸ ê¸°ëŠ¥ ì‚¬ìš©ë¥ **: ë¹ ë¥¸ ì…ë ¥ ë²„íŠ¼ ì‚¬ìš© 50% ì´ìƒ
- **ì €ì¥ ì„±ê³µë¥ **: 98% ì´ìƒ (ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ê³ ë ¤)

### ì‚¬ìš©ì ë§Œì¡±ë„
- **ì¸í„°í˜ì´ìŠ¤ ë§Œì¡±ë„**: 4.5/5.0 ì´ìƒ
- **ì™„ë£Œ ì†Œìš” ì‹œê°„**: ëª¨ë“œë³„ ëª©í‘œ ì‹œê°„ ë‚´ 80% ë‹¬ì„±
- **ì¬ì‚¬ìš© ì˜í–¥**: 90% ì´ìƒ

---

**ğŸ“… ë¬¸ì„œ ìƒì„±**: 2025-07-31  
**ì²´í¬í¬ì¸íŠ¸ ê¸°ë°˜**: 7/29 PersonalNotesView ìŠ¤ë§ˆíŠ¸ ë©”ëª¨ ì‹œìŠ¤í…œ  
**êµ¬í˜„ ìƒíƒœ**: v1.0.0-rc, ëª¨ë“œë³„ ì™„ë£Œ í”Œë¡œìš° ì„¤ê³„ ì™„ë£Œ